---
title: "Runtime Compliance API"
linkTitle: "Runtime Compliance"
weight: 4
---

### Overview

As of 3.1, Anchore has introduced new features that allow users to gain insight into the security compliance of their runtime environment through a new runtime compliance API. This API is designed to be general purpose so it can be consumed by a variety of tools that are responsible for executing the actual compliance checks on a running environment. One example are the Security Technical Implementation Guides (STIGs) that can be run on a kubernetes cluster by Anchore's [Remote Execution Manager (REM)]({{< ref "/docs/overview/runtime_compliance/compliance_check" >}}). By uploading the results of a given compliance into Anchore, users can leverage additional Anchore functionality like reporting and correlating the runtime environment to images analyzed by Anchore. This allows users to gain a deeper understanding of the lifecycle of the images they utilize and the ongoing security of the runtime environments using those images.


### Usage

The Compliance API can be found in the [Enterprise API swagger specification](/current/docs/using/api_usage/specs/enterprise_api_swagger.yaml). This API allows for the creation and retrieval of runtime compliance checks, as well as any document reports provided in the creation calls.

The following is an example of the body of an API call to create a runtime compliance check using the Compliance API to be submitted as a multipart form in order to support file upload:
```
{
  "check_type": "oscap", // type of compliance check to report
  "result": "pass", // overall result of compliance check
  "pod": "postgres-9.6", // k8 pod that the compliance check was run against
  "namespace": "dev", // the namespace of the pod
  "image_tag": "9.6", // tag of the image that the pod is running
  "image_digest": "sha256:a435b8edc3bdb4d766818dc6ce22ca3a5e6a922d19ca7001afd1359d060500eb", // the digest of the running image
  "start_time": "2021-03-22T15:12:24.580054", // start time of the compliance run
  "end_time": "2021-03-22T16:02:24.580054" // end time of the compliance run
  "result_file": "path_to_file",
  "report_file": "path_to_file
}
```

There are two fields required for the creation of runtime compliance checks. The `type` field is meant to reference the type of scan that is generating the report. As of right now, the only supported option is `oscap`, which stands for OpenSCAP, but this is expected to grow with future releases. The other required field is `image_digest`, which represent the image present in the container that the runtime compliance check was run against. 

While not required, the `status` attribute is used to designate whether the given compliance check has passed or failed. There are also a number of additional metadata fields provided to further contextualize the runtime check, such as the `pod` and `namespace` that the check was run against. 


One of the other key functionalities of this API is the ability to attach a `report_file` and a `result_file` to the created runtime compliance checks. This can be the direct output generated by the runtime tool itself, such as an OpenSCAP XML document. This allows for entire reports to be store within Anchore using the [object storage]({{< ref "/docs/installation/storage/object_store" >}}), which allows for a number of options for how and where this data will be preserved.  

Once created, runtime compliance checks can be retrieved using the GET endpoint specified in the swagger spec. The corresponding result and report files can be retrieved by pulling the `file_ids` from a runtime compliance check and querying the endpoint for runtime compliance results using the specified `result_id`.

